<!-- ADD MAPPING -->
<form [formGroup]="alarmsCountMappingFormGroup" style="width: 650px;">
  <mat-toolbar fxLayout="row" color="primary">
    <h2>{{ (isAdd ? 'tb.rulenode.add-mapping' : 'tb.rulenode.edit-mapping') | translate}}</h2>
    <span fxFlex></span>
    <button mat-icon-button (click)="cancel()" type="button">
      <mat-icon class="material-icons">close</mat-icon>
    </button>
  </mat-toolbar>
  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async"></mat-progress-bar>
  <div style="height: 4px;" *ngIf="(isLoading$ | async) === false"></div>

  <fieldset [disabled]="isLoading$ | async">
    <div fxFlex fxLayout="column">
      <mat-form-field fxFlex class="mat-block">
        <mat-label translate>tb.rulenode.target-telemetry</mat-label>
        <input matInput formControlName="target">
        <mat-error *ngIf="alarmsCountMappingFormGroup.get('target').hasError('required')">
          tb.rulenode.target-telemetry-required
        </mat-error>
      </mat-form-field>
    </div>
  </fieldset>

  <br>
  <div>
    <mat-form-field style="width: 100%;">
      <mat-label>
        tb.rulenode.status-filter
      </mat-label>
      <mat-select formControlName="statusList" multiple>
        <mat-select-trigger>
          <mat-chip-listbox>
            <mat-chip
              *ngFor="let status of alarmsCountMappingFormGroup.get('statusList').value;"
              [removable]="true" (removed)="remove(status, 'status')">
              {{ status }}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip>
          </mat-chip-listbox>
        </mat-select-trigger>

        <mat-option *ngFor="let alrStatus of alarmStatusList" [value]="alrStatus">
          <div fxFlex="50" style="width: 50px;" fxLayoutAlign="start">
            {{alrStatus}}
          </div>
        </mat-option>

      </mat-select>

    </mat-form-field>
  </div>
  <br>

  <div>
    <mat-form-field style="width: 100%;">
      <mat-label>
        tb.rulenode.severity-filter
      </mat-label>
      <mat-select formControlName="severityList" multiple>
        <mat-select-trigger>
          <mat-chip-listbox>
            <mat-chip
              *ngFor="let severity of alarmsCountMappingFormGroup.get('severityList').value;"
              [removable]="true" (removed)="remove(severity, 'severity')">
              {{ severity }}
              <mat-icon matChipRemove>cancel</mat-icon>
            </mat-chip>
          </mat-chip-listbox>
        </mat-select-trigger>

        <mat-option *ngFor="let severity of severityFilterList" [value]="severity">
          <div fxFlex="50" style="width: 50px;" fxLayoutAlign="start">
            {{severity}}
          </div>
        </mat-option>

      </mat-select>

    </mat-form-field>
  </div>
  <br>

  <div>
    <mat-form-field style="width: 100%;">
      <mat-label>
        tb.rulenode.type-filter
      </mat-label>
      <mat-chip-grid #chipGrid aria-label="Type filter" formControlName="typesList">
        <mat-chip-row *ngFor="let type of typesFilterList" (removed)="remove(type, 'type')"
                      [editable]="true" [aria-description]="'+ Alarm type'">
          {{type}}
          <button matChipRemove [attr.aria-label]="'remove ' + type">
            <mat-icon>cancel</mat-icon>
          </button>
        </mat-chip-row>

        <input placeholder="+ Alarm type" [matChipInputFor]="chipGrid"
               (matChipInputTokenEnd)="addChip($event)" />
      </mat-chip-grid>
    </mat-form-field>
  </div>
  <br>

  <!-- <div style="width: 100%;">{{specifyInterval |json}}
      <mat-checkbox [checked]="specifyInterval" formControlName="specifyInterval"
          (change)="checkSpecifyInterval($event)">{{'tb.rulenode.specify-interval'|translate}}</mat-checkbox>
  </div>
  <br>

  <div>
      <tb-timeinterval
                      formControlName="latestInterval"
                      predefinedName="timewindow.realtime"
                      [fxShow]="true"
                      [ngModelOptions]="{ standalone: true}"
                      style="padding-top: 8px;">
      </tb-timeinterval>
  </div>-->


  <!-- <mat-checkbox [(ngModel)]="specifyInterval" [ngModelOptions]="{ standalone: true}"
       (ngModelChange)="specifyIntervalChange()" style="display: block; margin-bottom: 16px;">
       {{ 'tb.rulenode.specify-interval' | translate }}
   </mat-checkbox>  -->
  <!-- <div style="width: 100%;">{{specifyInterval |json}}
      <mat-checkbox [checked]="specifyInterval" formControlName="specifyInterval"
          (change)="checkSpecifyInterval($event)">{{'tb.rulenode.specify-interval'|translate}}
      </mat-checkbox>
  </div> -->

  <br>
  <div style="width: 100%;">{{specifyInterval |json}}
    <mat-checkbox [checked]="specifyInterval" formControlName="specifyInterval"
                  (change)="checkSpecifyInterval($event)">{{'tb.rulenode.specify-interval'|translate}}</mat-checkbox>
  </div>

  <tb-timeinterval
    predefinedName="timewindow.realtime"
    formControlName = "latestInterval"
    subscriptSizing="dynamic"
    style="padding-top: 8px">
  </tb-timeinterval>


</form>

<mat-dialog-actions>
  <div mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">
    <span fxFlex></span>
    <!--          <button mat-button color="primary" type="button" (click)="saveMapping()" [disabled]="(isLoading$ | async) ">-->
    <!--              &lt;!&ndash;|| alarmsCountMappingFormGroup.invalid || !alarmsCountMappingFormGroup.dirty&ndash;&gt;-->
    <!--              {{ (isAdd ? 'action.add' : 'action.save') }}-->
    <!--          </button>-->
    <button mat-button color="primary" style="margin-right: 20px;" type="button"
            [disabled]="(isLoading$ | async)" (click)="cancel()" cdkFocusInitial>
      action.cancel
    </button>
  </div>
</mat-dialog-actions>
